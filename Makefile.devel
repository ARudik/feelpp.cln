# This is the developer's makefile, not the user's makefile.
# Don't use it unless you know exactly what you do!


# Some important programs:
SHELL = /bin/sh
MAKE = make


# GNU tar together with GNU bzip2. Excellent performance.
PACK = tar
PACKOPT = cvfhj
PACKEXT = .tar.bz2


all : configures documentation


CONFIGURES = configure
CONFIGURES_IN = configure.ac

AUTOCONF_FILES = autoconf/aclocal.m4 autoconf/autoconf.m4f autoconf/acgeneral.m4 autoconf/acspecific.m4

configures : $(CONFIGURES)

configure : configure.ac $(AUTOCONF_FILES)
	./autoconf/autoconf -A autoconf -l autoconf

CLISP_ACLOCAL = /home/kreckel/contrib/clisp/src/autoconf/aclocal.m4
ACSELECT = /home/kreckel/contrib/clisp/src/autoconf/acselect
LIBTOOLMACROS = /home/kreckel/contrib/libtool/libtool.m4

autoconf/aclocal.m4 : $(CLISP_ACLOCAL) autoconf/acinclude.m4
	($(ACSELECT) `cat $(CONFIGURES_IN) | grep '^[A-Z][A-Z]_' | sed 's,[^A-Z_].*$$,,g' | sort | uniq` < $(CLISP_ACLOCAL) ; cat $(LIBTOOLMACROS) | sed -e 's,AC_CANONICAL_HOST,CL_CANONICAL_HOST,g' -e 's,AC_PROG_RANLIB,CL_PROG_RANLIB,g'; cat autoconf/acinclude.m4) > autoconf/aclocal.m4

# Syntaxcheck
check-configures : $(CONFIGURES)
	set -e; for f in $(CONFIGURES); do bash -x -n $$f; done


documentation : force
	cd doc && $(MAKE) -f Makefile.devel documentation

force :

